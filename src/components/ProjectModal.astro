---
import { Image } from 'astro:assets';

const { project, modalStrings } = Astro.props;
const { image, title, detailedDescription, tags, github, live } = project;
const modalId = `modal-${title.replace(/\s+/g, '-').toLowerCase()}`;
---

<div 
    id={modalId} 
    class="fixed inset-0 bg-black/80 backdrop-blur-sm z-50 hidden items-center justify-center p-4 transition-opacity duration-300" 
    aria-labelledby={`title-${modalId}`} 
    role="dialog" 
    aria-modal="true"
>
    <div class="bg-gray-800 rounded-lg shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto relative border border-gray-700" data-modal-content>
        <!-- Close Button -->
        <button data-modal-close={modalId} class="absolute top-3 right-3 text-gray-400 hover:text-white z-10" aria-label={modalStrings.close}>
            <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12">
                </path>
            </svg>
        </button>

        {image && (
            <div class="w-full h-56 md:h-72 bg-gray-900 rounded-t-lg">
                <Image src={image} alt={`Screenshot del progetto ${title}`} class="w-full h-full object-contain p-4" loading="lazy" quality={85} />
            </div>
        )}

        <div class="p-6 md:p-8">
            <h3 id={`title-${modalId}`} class="text-2xl md:text-3xl font-bold mb-4">{title}</h3>
            
            <div class="flex flex-wrap gap-2 mb-6">
                {tags.map((tag: string) => (
                    <span class="text-xs bg-gray-700 text-blue-300 px-2 py-1 rounded-full">{tag}</span>
                ))}
            </div>

            <p class="text-gray-300 leading-relaxed">{detailedDescription}</p>

            <div class="flex flex-col sm:flex-row justify-center gap-4 mt-8 pt-4 border-t border-gray-700">
                {github && (
                    <a href={github} target="_blank" rel="noopener noreferrer" class="w-full sm:w-auto text-center bg-gray-700 hover:bg-gray-600 text-white font-bold py-3 px-6 rounded-lg transition-colors" aria-label={`${modalStrings.githubAriaLabel} ${title} su GitHub`}>
                        {modalStrings.github}
                    </a>
                )}
                {live && (
                     <a href={live} target="_blank" rel="noopener noreferrer" class="w-full sm:w-auto text-center bg-blue-600 hover:bg-blue-500 text-white font-bold py-3 px-6 rounded-lg transition-colors" aria-label={`${modalStrings.liveSiteAriaLabel} ${title}`}>
                        {modalStrings.liveSite}
                    </a>
                )}
            </div>
        </div>
    </div>
</div>